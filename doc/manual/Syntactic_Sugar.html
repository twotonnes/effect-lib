<!DOCTYPE html>
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>4&nbsp;Syntactic Sugar</title><link rel="stylesheet" type="text/css" href="../scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="../racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../manual-racket.css" title="default"/><link rel="stylesheet" type="text/css" href="../doc-site.css" title="default"/><script type="text/javascript" src="../scribble-common.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../manual-racket.js"></script><script type="text/javascript" src="../doc-site.js"></script><script type="text/javascript" src="file:///C:/Program%20Files/Racket/doc/local-redirect/local-redirect.js"></script><script type="text/javascript" src="file:///C:/Users/Niels/AppData/Roaming/Racket/9.0/doc/local-redirect/local-user-redirect.js"></script></head><body id="doc-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">Effect Lib</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="Overview.html" class="tocviewlink" data-pltdoc="x">Overview</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="Types_and_Structures.html" class="tocviewlink" data-pltdoc="x">Types and Structures</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="Monadic_Operations.html" class="tocviewlink" data-pltdoc="x">Monadic Operations</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Syntactic Sugar</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>4&nbsp;</td><td><a href="" class="tocviewselflink" data-pltdoc="x">Syntactic Sugar</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">4.1&nbsp;</td><td><a href="#%28part._do-notation%29" class="tocviewlink" data-pltdoc="x">Do-<wbr></wbr>Notation</a></td></tr><tr><td align="right">4.2&nbsp;</td><td><a href="#%28part._.Effect_.Handlers%29" class="tocviewlink" data-pltdoc="x">Effect Handlers</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">4.1<span class="stt">&nbsp;</span></span><a href="#%28part._do-notation%29" class="tocsubseclink" data-pltdoc="x">Do-<wbr></wbr>Notation</a></td></tr><tr><td><a href="#%28form._%28%28lib._effect-lib%2Fmain..rkt%29._do%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">do</span></span></a></td></tr><tr><td><span class="tocsublinknumber">4.2<span class="stt">&nbsp;</span></span><a href="#%28part._.Effect_.Handlers%29" class="tocsubseclink" data-pltdoc="x">Effect Handlers</a></td></tr><tr><td><a href="#%28form._%28%28lib._effect-lib%2Fmain..rkt%29._with-effect-handlers%29%29" class="tocsubnonseclink" data-pltdoc="x"><span class="RktSym"><span class="RktStxLink">with-<wbr></wbr>effect-<wbr></wbr>handlers</span></span></a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;9.0&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;9.0&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="Monadic_Operations.html" title="backward to &quot;3 Monadic Operations&quot;" data-pltdoc="x" rel="prev">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Effect Lib&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div><section class="SsectionLevel2" id="section 4"><h2 x-source-module="(lib &quot;effect-lib/scribblings/manual.scrbl&quot;)" x-source-pkg="effect-lib" x-part-tag="&quot;Syntactic_Sugar&quot;" class="heading">4<span class="stt">&nbsp;</span><a name="(part._.Syntactic_.Sugar)"></a>Syntactic Sugar<span class="button-group"><a href="#(part._.Syntactic_.Sugar)" class="heading-anchor" title="Link to here">ðŸ”—</a><a class="heading-source" title="Internal Scribble link and Scribble source">â„¹</a><span style="visibility: hidden"> </span></span></h2><section class="SsectionLevel3" id="section 4.1"><h3 x-source-module="(lib &quot;effect-lib/scribblings/manual.scrbl&quot;)" x-source-pkg="effect-lib" x-part-tag="&quot;do-notation&quot;" class="heading">4.1<span class="stt">&nbsp;</span><a name="(part._do-notation)"></a>Do-Notation<span class="button-group"><a href="#(part._do-notation)" class="heading-anchor" title="Link to here">ðŸ”—</a><a class="heading-source" title="Internal Scribble link and Scribble source">â„¹</a><span style="visibility: hidden"> </span></span></h3><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._effect-lib/main..rkt)._do))"></a><span title="Provided from: effect-lib | Package: effect-lib"><span class="RktSym"><a href="#%28form._%28%28lib._effect-lib%2Fmain..rkt%29._do%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">do</a></span></span><span class="hspace">&nbsp;</span><span class="RktVar">stmt</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="specgrammar"><tr><td align="right" valign="baseline"><span class="RktVar">stmt</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">[</span><span class="RktVar">var</span><span class="hspace">&nbsp;</span><span class="RktVar">&lt;-</span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span><span class="RktPn">]</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">[</span><span class="RktVar">var</span><span class="hspace">&nbsp;</span><span class="RktVar">:</span><span class="hspace">&nbsp;</span><span class="RktVar">type</span><span class="hspace">&nbsp;</span><span class="RktVar">&lt;-</span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span><span class="RktPn">]</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktVar">expr</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Syntactic sugar for monadic sequencing using do-notation. The <span class="RktSym"><a href="#%28form._%28%28lib._effect-lib%2Fmain..rkt%29._do%29%29" class="RktStxLink" data-pltdoc="x">do</a></span> form simplifies the construction of sequences of effectful operations, avoiding deeply nested lambda expressions.</div></p><p><div class="SIntrapara"><span style="font-style: italic">Grammar:</span>
</div><div class="SIntrapara"><ul><li><p><span class="RktPn">[</span><span class="RktVar">var</span><span class="stt"> </span><span class="RktVar">&lt;-</span><span class="stt"> </span><span class="RktVar">expr</span><span class="RktPn">]</span> binds the result of the effectful computation <span class="RktVar">expr</span> to <span class="RktVar">var</span> for use in subsequent statements. The <span class="RktVar">expr</span> must have type <span class="RktPn">(</span><span class="RktSym"><a href="Types_and_Structures.html#%28def._%28%28lib._effect-lib%2Fmain..rkt%29._.Eff%29%29" class="RktValLink" data-pltdoc="x">Eff</a></span><span class="stt"> </span><span class="RktSym">A</span><span class="RktPn">)</span> for some type <span class="RktSym">A</span>, and <span class="RktVar">var</span> has type <span class="RktSym">A</span>.</p></li><li><p><span class="RktPn">[</span><span class="RktVar">var</span><span class="stt"> </span><span class="RktVar">:</span><span class="stt"> </span><span class="RktVar">type</span><span class="stt"> </span><span class="RktVar">&lt;-</span><span class="stt"> </span><span class="RktVar">expr</span><span class="RktPn">]</span> is the same as <span class="RktPn">[</span><span class="RktVar">var</span><span class="stt"> </span><span class="RktVar">&lt;-</span><span class="stt"> </span><span class="RktVar">expr</span><span class="RktPn">]</span>, but includes an explicit type annotation for <span class="RktVar">var</span>. This is useful when type inference would be ambiguous.</p></li><li><p><span class="RktVar">expr</span> (a plain expression without binding) evaluates the expression and discards its result, continuing with the next statement. This is useful for effects that matter only for their side effects, not their return value.</p></li></ul></div></p><p><span style="font-style: italic">Expansion:</span>
All <span class="RktSym"><a href="#%28form._%28%28lib._effect-lib%2Fmain..rkt%29._do%29%29" class="RktStxLink" data-pltdoc="x">do</a></span> sequences expand to nested <span class="RktSym"><a href="Monadic_Operations.html#%28def._%28%28lib._effect-lib%2Fmain..rkt%29._~3e~3e~3d%29%29" class="RktValLink" data-pltdoc="x">&gt;&gt;=</a></span> calls. For example:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._effect-lib%2Fmain..rkt%29._do%29%29" class="RktStxLink" data-pltdoc="x">do</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">[</span><span class="RktSym">x</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">:</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">Integer</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">&lt;-</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="Monadic_Operations.html#%28def._%28%28lib._effect-lib%2Fmain..rkt%29._return%29%29" class="RktValLink" data-pltdoc="x">return</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">[</span><span class="RktSym">y</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">:</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">Integer</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">&lt;-</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="Monadic_Operations.html#%28def._%28%28lib._effect-lib%2Fmain..rkt%29._return%29%29" class="RktValLink" data-pltdoc="x">return</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">]</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="Monadic_Operations.html#%28def._%28%28lib._effect-lib%2Fmain..rkt%29._return%29%29" class="RktValLink" data-pltdoc="x">return</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">+</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">x</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote><p>expands to:</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><a href="Monadic_Operations.html#%28def._%28%28lib._effect-lib%2Fmain..rkt%29._~3e~3e~3d%29%29" class="RktValLink" data-pltdoc="x">&gt;&gt;=</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="Monadic_Operations.html#%28def._%28%28lib._effect-lib%2Fmain..rkt%29._return%29%29" class="RktValLink" data-pltdoc="x">return</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="Monadic_Operations.html#%28def._%28%28lib._effect-lib%2Fmain..rkt%29._~3e~3e~3d%29%29" class="RktValLink" data-pltdoc="x">&gt;&gt;=</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="Monadic_Operations.html#%28def._%28%28lib._effect-lib%2Fmain..rkt%29._return%29%29" class="RktValLink" data-pltdoc="x">return</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">lambda</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><a href="Monadic_Operations.html#%28def._%28%28lib._effect-lib%2Fmain..rkt%29._return%29%29" class="RktValLink" data-pltdoc="x">return</a></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym">+</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">x</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote><p><div class="SIntrapara">Examples:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._effect-lib%2Fmain..rkt%29._do%29%29" class="RktStxLink" data-pltdoc="x">do</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVar">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Integer</span><span class="hspace">&nbsp;</span><span class="RktVar">&lt;-</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Monadic_Operations.html#%28def._%28%28lib._effect-lib%2Fmain..rkt%29._return%29%29" class="RktValLink" data-pltdoc="x">return</a></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym">y</span><span class="hspace">&nbsp;</span><span class="RktVar">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Integer</span><span class="hspace">&nbsp;</span><span class="RktVar">&lt;-</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Monadic_Operations.html#%28def._%28%28lib._effect-lib%2Fmain..rkt%29._return%29%29" class="RktValLink" data-pltdoc="x">return</a></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Monadic_Operations.html#%28def._%28%28lib._effect-lib%2Fmain..rkt%29._return%29%29" class="RktValLink" data-pltdoc="x">return</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">+</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><span class="RktOut">- : (U (effect Integer) (pure Integer))</span></p></td></tr><tr><td><p><span class="RktRes">(pure 3)</span></p></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._effect-lib%2Fmain..rkt%29._do%29%29" class="RktStxLink" data-pltdoc="x">do</a></span><span class="hspace">&nbsp;</span><span class="RktPn">[</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVar">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Integer</span><span class="hspace">&nbsp;</span><span class="RktVar">&lt;-</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Monadic_Operations.html#%28def._%28%28lib._effect-lib%2Fmain..rkt%29._return%29%29" class="RktValLink" data-pltdoc="x">return</a></span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Monadic_Operations.html#%28def._%28%28lib._effect-lib%2Fmain..rkt%29._return%29%29" class="RktValLink" data-pltdoc="x">return</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">*</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><span class="RktOut">- : (U (effect Integer) (pure Integer))</span></p></td></tr><tr><td><p><span class="RktRes">(pure 20)</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._effect-lib%2Fmain..rkt%29._do%29%29" class="RktStxLink" data-pltdoc="x">do</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">id</span></span></span><span class="hspace">&nbsp;</span><span class="RktVal">42</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktOut">- : (U (effect Any) (pure Any))</span></p></td></tr><tr><td><p><span class="RktRes">(effect (id-effect ...) #&lt;procedure:...fects/id-effect.rkt:13:26&gt;)</span></p></td></tr></table></blockquote></div></p></section><section class="SsectionLevel3" id="section 4.2"><h3 x-source-module="(lib &quot;effect-lib/scribblings/manual.scrbl&quot;)" x-source-pkg="effect-lib" x-part-tag="&quot;Effect_Handlers&quot;" class="heading">4.2<span class="stt">&nbsp;</span><a name="(part._.Effect_.Handlers)"></a>Effect Handlers<span class="button-group"><a href="#(part._.Effect_.Handlers)" class="heading-anchor" title="Link to here">ðŸ”—</a><a class="heading-source" title="Internal Scribble link and Scribble source">â„¹</a><span style="visibility: hidden"> </span></span></h3><p><div class="SIntrapara"><blockquote class="SVInsetFlow"><table cellspacing="0" cellpadding="0" class="boxed RBoxed"><tr><td><blockquote class="SubFlow"><div class="RBackgroundLabel SIEHidden"><div class="RBackgroundLabelInner"><p>syntax</p></div></div><p class="RForeground"><span class="RktPn">(</span><a name="(form._((lib._effect-lib/main..rkt)._with-effect-handlers))"></a><span title="Provided from: effect-lib | Package: effect-lib"><span class="RktSym"><a href="#%28form._%28%28lib._effect-lib%2Fmain..rkt%29._with-effect-handlers%29%29" class="RktStxDef RktStxLink" data-pltdoc="x">with-effect-handlers</a></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">clause</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVar">expr</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">)</span></p></blockquote></td></tr><tr><td><span class="stt">&nbsp;</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="specgrammar"><tr><td align="right" valign="baseline"><span class="RktVar">clause</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">=</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">[</span><span class="RktVar">pattern</span><span class="hspace">&nbsp;</span><span class="RktVar">body</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktVar">abort</span><span class="hspace">&nbsp;</span><span class="RktVar">result</span><span class="RktPn">)</span><span class="RktPn">]</span></td></tr><tr><td align="right" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="center" valign="baseline">|</td><td align="left" valign="baseline"><span class="stt">&nbsp;</span></td><td align="left" valign="baseline"><span class="RktPn">[</span><span class="RktVar">pattern</span><span class="hspace">&nbsp;</span><span class="RktVar">body</span><span class="hspace">&nbsp;</span><span class="RktMeta">...</span><span class="RktPn">]</span></td></tr></table></td></tr></table></blockquote></div><div class="SIntrapara">Macro for pattern-matching effect handlers. Provides a convenient way to handle specific effect types within an expression.</div></p><p><span style="font-style: italic">Clauses:</span></p><p>Each clause in <span class="RktPn">(</span><span class="RktVar">clause</span><span class="stt"> </span><span class="RktMeta">...</span><span class="RktPn">)</span> matches against an <span class="RktSym"><a href="Types_and_Structures.html#%28def._%28%28lib._effect-lib%2Fmain..rkt%29._effect%29%29" class="RktValLink" data-pltdoc="x">effect</a></span> structure and processes it:</p><ul><li><p><span class="RktPn">[</span><span class="RktVar">pattern</span><span class="stt"> </span><span class="RktVar">body</span><span class="stt"> </span><span class="RktMeta">...</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktVar">abort</span><span class="stt"> </span><span class="RktVar">result</span><span class="RktPn">)</span><span class="RktPn">]</span> matches <span class="RktVar">pattern</span> against the effect description. If matched, the <span class="RktVar">body</span> expressions are evaluated, and then <span class="RktPn">(</span><span class="RktVar">abort</span><span class="stt"> </span><span class="RktVar">result</span><span class="RktPn">)</span> short-circuits the computation, returning <span class="RktVar">result</span> as a pure value without invoking the effect&rsquo;s continuation.</p></li><li><p><span class="RktPn">[</span><span class="RktVar">pattern</span><span class="stt"> </span><span class="RktVar">body</span><span class="stt"> </span><span class="RktMeta">...</span><span class="RktPn">]</span> matches <span class="RktVar">pattern</span> against the effect description. If matched, the <span class="RktVar">body</span> expressions are evaluated, and their result is passed to the effect&rsquo;s continuation via <span class="RktSym"><a href="Monadic_Operations.html#%28def._%28%28lib._effect-lib%2Fmain..rkt%29._~3e~3e~3d%29%29" class="RktValLink" data-pltdoc="x">&gt;&gt;=</a></span>. This allows the handler to produce a value that feeds back into the computation.</p></li></ul><p>If an effect is encountered that doesn&rsquo;t match any clause, an error is raised indicating the unhandled effect.</p><p><div class="SIntrapara">Example:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><a href="#%28form._%28%28lib._effect-lib%2Fmain..rkt%29._with-effect-handlers%29%29" class="RktStxLink" data-pltdoc="x">with-effect-handlers</a></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><a href="Monadic_Operations.html#%28def._%28%28lib._effect-lib%2Fmain..rkt%29._return%29%29" class="RktValLink" data-pltdoc="x">return</a></span><span class="hspace">&nbsp;</span><span class="RktVal">42</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr><tr><td><p><span class="RktOut">- : Any</span></p></td></tr><tr><td><p><span class="RktRes">42</span></p></td></tr></table></blockquote></div></p></section></section><div class="navsetbottom"><span class="navleft"><form class="searchform"><input class="searchbox" id="searchbox" type="text" tabindex="1" placeholder="...search manuals..." title="Enter a search string to search the manuals" onkeypress="return DoSearchKey(event, this, &quot;9.0&quot;, &quot;../&quot;);"/></form>&nbsp;&nbsp;<a href="../index.html" title="up to the documentation top" data-pltdoc="x" onclick="return GotoPLTRoot(&quot;9.0&quot;);">top</a><span class="tocsettoggle">&nbsp;&nbsp;<a href="javascript:void(0);" title="show/hide table of contents" onclick="TocsetToggle();">contents</a></span></span><span class="navright">&nbsp;&nbsp;<a href="Monadic_Operations.html" title="backward to &quot;3 Monadic Operations&quot;" data-pltdoc="x" rel="prev">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;Effect Lib&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<span class="nonavigation">next &rarr;</span></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>